<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Enviar_notifica_o_de_liga_o_conclu_da_consultor</name>
        <label>Enviar notificação de ligação concluída Consultor</label>
        <locationX>72</locationX>
        <locationY>2411</locationY>
        <actionName>sendConversationMessages</actionName>
        <actionType>sendConversationMessages</actionType>
        <connector>
            <targetReference>Atribuir_valores_para_nova_Task</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>messageDefinitionName</name>
            <value>
                <stringValue>Jornada_do_Cliente_Liga_o_Conclu_da_Consultor</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingDefinitionInputParameters</name>
            <value>
                <apexValue>[
  {
    &quot;name&quot;: &quot;oppName&quot;,
    &quot;textValue&quot;: &quot;{!oppName}&quot;
  },
  {
    &quot;name&quot;: &quot;managerName&quot;,
    &quot;textValue&quot;: &quot;{!managerName}&quot;
  },
  {
    &quot;name&quot;: &quot;customerName&quot;,
    &quot;textValue&quot;: &quot;{!customerName}&quot;
  }
]</apexValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>requestType</name>
            <value>
                <stringValue>SendNotificationMessages</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>isEnforceMessagingChannelConsent</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelConsentType</name>
            <value>
                <stringValue>MessagingEndUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>allowedSessionStatus</name>
            <value>
                <stringValue>Any</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingEndUserIds</name>
            <value>
                <elementReference>messagingUserIdsConsultant</elementReference>
            </value>
        </inputParameters>
        <nameSegment>sendConversationMessages</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Enviar_notifica_o_de_liga_o_concluida</name>
        <label>Enviar notificação de ligação concluida</label>
        <locationX>72</locationX>
        <locationY>2303</locationY>
        <actionName>sendConversationMessages</actionName>
        <actionType>sendConversationMessages</actionType>
        <connector>
            <targetReference>Enviar_notifica_o_de_liga_o_conclu_da_consultor</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>messageDefinitionName</name>
            <value>
                <stringValue>Jornada_do_Cliente_Liga_o_Conclu_da</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingDefinitionInputParameters</name>
            <value>
                <apexValue>[
  {
    &quot;name&quot;: &quot;managerName&quot;,
    &quot;textValue&quot;: &quot;{!managerName}&quot;
  },
  {
    &quot;name&quot;: &quot;oppName&quot;,
    &quot;textValue&quot;: &quot;{!oppName}&quot;
  },
  {
    &quot;name&quot;: &quot;customerName&quot;,
    &quot;textValue&quot;: &quot;{!customerName}&quot;
  }
]</apexValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>requestType</name>
            <value>
                <stringValue>SendNotificationMessages</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>isEnforceMessagingChannelConsent</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelConsentType</name>
            <value>
                <stringValue>MessagingEndUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>allowedSessionStatus</name>
            <value>
                <stringValue>Any</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingEndUserIds</name>
            <value>
                <elementReference>messagingUserIds</elementReference>
            </value>
        </inputParameters>
        <nameSegment>sendConversationMessages</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Enviar_notifica_o_de_start</name>
        <label>Enviar notificação de start</label>
        <locationX>468</locationX>
        <locationY>2303</locationY>
        <actionName>sendConversationMessages</actionName>
        <actionType>sendConversationMessages</actionType>
        <connector>
            <targetReference>Notification_sent</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>messageDefinitionName</name>
            <value>
                <stringValue>Jornada_do_Cliente_Start</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingDefinitionInputParameters</name>
            <value>
                <apexValue>[
  {
    &quot;name&quot;: &quot;customerName&quot;,
    &quot;textValue&quot;: &quot;{!customerName}&quot;
  },
  {
    &quot;name&quot;: &quot;oppName&quot;,
    &quot;textValue&quot;: &quot;{!oppName}&quot;
  }
]</apexValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>requestType</name>
            <value>
                <stringValue>SendNotificationMessages</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>isEnforceMessagingChannelConsent</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelConsentType</name>
            <value>
                <stringValue>MessagingEndUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>allowedSessionStatus</name>
            <value>
                <stringValue>Any</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingEndUserIds</name>
            <value>
                <elementReference>messagingUserIds</elementReference>
            </value>
        </inputParameters>
        <nameSegment>sendConversationMessages</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>messageGUIDs</assignToReference>
            <name>messageIdentifiers</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Enviar_notifica_o_de_start_importante</name>
        <label>Enviar notificação de start importante</label>
        <locationX>336</locationX>
        <locationY>2519</locationY>
        <actionName>sendConversationMessages</actionName>
        <actionType>sendConversationMessages</actionType>
        <connector>
            <targetReference>Atribuir_valores_para_nova_Task</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>messageDefinitionName</name>
            <value>
                <stringValue>Jornada_do_Cliente_Start_2</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingDefinitionInputParameters</name>
            <value>
                <apexValue>[
  {
    &quot;name&quot;: &quot;password&quot;,
    &quot;textValue&quot;: &quot;{!password}&quot;
  },
  {
    &quot;name&quot;: &quot;login&quot;,
    &quot;textValue&quot;: &quot;{!login}&quot;
  }
]</apexValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>requestType</name>
            <value>
                <stringValue>SendNotificationMessages</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>isEnforceMessagingChannelConsent</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelConsentType</name>
            <value>
                <stringValue>MessagingEndUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>allowedSessionStatus</name>
            <value>
                <stringValue>Any</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>messagingEndUserIds</name>
            <value>
                <elementReference>messagingUserIds</elementReference>
            </value>
        </inputParameters>
        <nameSegment>sendConversationMessages</nameSegment>
        <offset>0</offset>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>62.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Atribui_somente_cliente</name>
        <label>Atribui somente cliente</label>
        <locationX>50</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>messagingUserIds</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>{!Consultar_Messaging_User.Id}</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>messagingUserId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Consultar_Messaging_User.MessagingChannelId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Atribuir_valores_para_disparo_da_mensagem</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_messagingUserId_criado</name>
        <label>Atribuir messagingUserId criado</label>
        <locationX>578</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>messagingUserIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>messagingUserId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>messagingUserIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Consultar_Messaging_User_Consultor.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Atribuir_valores_para_disparo_da_mensagem</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_messagingUserId_Existente</name>
        <label>Atribuir messagingUserId Existente</label>
        <locationX>314</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>messagingUserIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Consultar_Messaging_User.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>messagingUserIdsConsultant</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Consultar_Messaging_User_Consultor.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>messagingUserId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Consultar_Messaging_User.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Atribuir_valores_para_disparo_da_mensagem</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_valores_para_disparo_da_mensagem</name>
        <label>Atribuir valores para disparo da mensagem</label>
        <locationX>512</locationX>
        <locationY>1979</locationY>
        <assignmentItems>
            <assignToReference>nextAction</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.NextNotification__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>customerName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Consultar_Cliente.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>oppName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>oppNameFormula</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>agentName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>agentNameFormula</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Tipo_de_task_para_disparo_da_notificacao</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_valores_para_nova_Task</name>
        <label>Atribuir valores para nova Task</label>
        <locationX>512</locationX>
        <locationY>2795</locationY>
        <assignmentItems>
            <assignToReference>nextStep</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nextSubjectAndStatus</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>nextNotification</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>nextNotificationText</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>managerName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Obter_Oportunidade.ConcessionariaEnergia__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Fechar_Task</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_variaveis_de_Liga_o_Conclu_da</name>
        <label>Atribuir variaveis de Ligação Concluída</label>
        <locationX>72</locationX>
        <locationY>2195</locationY>
        <assignmentItems>
            <assignToReference>managerName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ConcessionariaEnergia__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Enviar_notifica_o_de_liga_o_concluida</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Atribuir_variaveis_de_Start</name>
        <label>Atribuir variaveis de Start</label>
        <locationX>468</locationX>
        <locationY>2195</locationY>
        <assignmentItems>
            <assignToReference>login</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Login__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>password</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Password__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Enviar_notifica_o_de_start</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Enviar_apenas_para_Cliente</name>
        <label>Enviar apenas para Cliente</label>
        <locationX>182</locationX>
        <locationY>1595</locationY>
        <defaultConnector>
            <targetReference>Atribuir_messagingUserId_Existente</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Resultado padrão</defaultConnectorLabel>
        <rules>
            <name>IsStart</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Start</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Atribui_somente_cliente</targetReference>
            </connector>
            <label>Start</label>
        </rules>
    </decisions>
    <decisions>
        <name>Notification_sent</name>
        <label>Notification sent</label>
        <locationX>468</locationX>
        <locationY>2411</locationY>
        <defaultConnector>
            <targetReference>Atribuir_valores_para_nova_Task</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Sent</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>messageGUIDs</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Enviar_notifica_o_de_start_importante</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Task_de_Jornada_do_Cliente</name>
        <label>Task de Jornada do Cliente?</label>
        <locationX>1084</locationX>
        <locationY>431</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Sim</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Jornada do Projeto</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Messaging_Channel</targetReference>
            </connector>
            <label>Sim</label>
        </rules>
    </decisions>
    <decisions>
        <name>Tipo_de_Task</name>
        <label>Tipo de Task</label>
        <locationX>512</locationX>
        <locationY>647</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Onboarding</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Onboarding</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Onboarding</label>
        </rules>
        <rules>
            <name>InformacoesIniciaisSubject</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Informações Iniciais</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Manager__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.KWP__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Informações Iniciais</label>
        </rules>
        <rules>
            <name>ProjetoAprovadoValidation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Projeto Aprovado</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ProjectApprovalDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Projeto Aprovado</label>
        </rules>
        <rules>
            <name>Instalacao_Materiais_WEG</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Instalação - Materiais WEG</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EstimatedDateKitWeb__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Instalação - Materiais WEG</label>
        </rules>
        <rules>
            <name>InstalacaoMateriaisValidation</name>
            <conditionLogic>1 AND 2 AND (3 OR 4)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Instalação - Materiais</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.DateAdditionalMaterial__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EstimatedDateKitWeb__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Instalação Materiais</label>
        </rules>
        <rules>
            <name>Instala_o_Montagem</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Instalação - Montagem</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.InstallDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Instalação - Montagem</label>
        </rules>
        <rules>
            <name>Instala_o_Vistoria</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Instalação - Vistoria</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.DateInspection__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FinishProjectDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Instalação - Vistoria</label>
        </rules>
        <rules>
            <name>Liga_o_Conclu_da</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Ligação Concluída</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Ligação Concluída</label>
        </rules>
        <rules>
            <name>StartValidation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Start</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Login__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Password__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Start</label>
        </rules>
        <rules>
            <name>Monitoramento</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Monitoramento</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Consultar_Caso_de_Jornada_do_Cliente</targetReference>
            </connector>
            <label>Monitoramento</label>
        </rules>
    </decisions>
    <decisions>
        <name>Tipo_de_task_para_disparo_da_notificacao</name>
        <label>Tipo de task para disparo da notificação</label>
        <locationX>512</locationX>
        <locationY>2087</locationY>
        <defaultConnectorLabel>Resultado padrão</defaultConnectorLabel>
        <rules>
            <name>Ligacao_Conclu_da</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Ligação Concluída</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Atribuir_variaveis_de_Liga_o_Conclu_da</targetReference>
            </connector>
            <label>Ligação Concluída</label>
        </rules>
        <rules>
            <name>Start</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Start</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Atribuir_variaveis_de_Start</targetReference>
            </connector>
            <label>Start</label>
        </rules>
        <rules>
            <name>Monitoramento_Message</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Monitoramento</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Atribuir_valores_para_nova_Task</targetReference>
            </connector>
            <label>Monitoramento</label>
        </rules>
    </decisions>
    <decisions>
        <name>Verificar_se_deve_criar_nova_task</name>
        <label>Verificar se deve criar nova task</label>
        <locationX>512</locationX>
        <locationY>3443</locationY>
        <defaultConnector>
            <targetReference>Criar_task_do_step_seguinte</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Resultado padrão</defaultConnectorLabel>
        <rules>
            <name>N_o_Criar_task</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>nextSubjectAndStatus</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CreateNewTaskAutomatically__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Não Criar task</label>
        </rules>
    </decisions>
    <decisions>
        <name>Verificar_se_Messaging_User_existe</name>
        <label>Verificar se Messaging User existe</label>
        <locationX>512</locationX>
        <locationY>1487</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Messaging_User_Cliente_Encontrado</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Consultar_Messaging_User.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Enviar_apenas_para_Cliente</targetReference>
            </connector>
            <label>Messaging User Cliente Encontrado</label>
        </rules>
        <rules>
            <name>Messaging_User_Cliente_N_o_Encontrado</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Consultar_Messaging_User</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Criar_Messaging_User</targetReference>
            </connector>
            <label>Messaging User Cliente Não Encontrado</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>agentNameFormula</name>
        <dataType>String</dataType>
        <expression>{!$Record.Owner:User.FirstName} + &quot; &quot; + {!$Record.Owner:User.LastName}</expression>
    </formulas>
    <formulas>
        <name>AppLoginPasswordPreenchidos</name>
        <dataType>Boolean</dataType>
        <expression>AND(
OR(ISCHANGED({!$Record.MonitoringApplication__c}), ISCHANGED({!$Record.Login__c}), ISCHANGED({!$Record.Password__c})),
AND(
NOT(ISNULL({!$Record.MonitoringApplication__c})) ,NOT(ISNULL({!$Record.Login__c})) , NOT(ISNULL({!$Record.Password__c}))
)
)</expression>
    </formulas>
    <formulas>
        <name>caseAdditionalMaterial</name>
        <dataType>Date</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.DateAdditionalMaterial__c})
),
{!$Record.DateAdditionalMaterial__c},
{!Obter_Caso.DateAdditionalMaterial__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseApp</name>
        <dataType>String</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.MonitoringApplication__c})
),
{!$Record.MonitoringApplication__c},
{!Obter_Caso.MonitoringApplication__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseDateInspection</name>
        <dataType>DateTime</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.DateInspection__c})
),
{!$Record.DateInspection__c},
{!Obter_Caso.DateInspection__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseEstimatedKITWeg</name>
        <dataType>Date</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.EstimatedDateKitWeb__c})
),
{!$Record.EstimatedDateKitWeb__c},
{!Obter_Caso.EstimatedDateKitWeb__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseInstallDate</name>
        <dataType>DateTime</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.InstallDate__c})
),
{!$Record.InstallDate__c},
{!Obter_Caso.InstallDate__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseKWP</name>
        <dataType>String</dataType>
        <expression>IF(
NOT(
ISBLANK({!$Record.KWP__c})
),
{!$Record.KWP__c},
{!Obter_Caso.KWP__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseLink</name>
        <dataType>String</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.Link__c})
),
{!$Record.Link__c},
{!Obter_Caso.Link__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseLogin</name>
        <dataType>String</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.Login__c})
),
{!$Record.Login__c},
{!Obter_Caso.Login__c}
)</expression>
    </formulas>
    <formulas>
        <name>casePassword</name>
        <dataType>String</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.Password__c})
),
{!$Record.Password__c},
{!Obter_Caso.Password__c}
)</expression>
    </formulas>
    <formulas>
        <name>caseProjectApprovalDate</name>
        <dataType>Date</dataType>
        <expression>IF(
NOT(
ISNULL({!$Record.ProjectApprovalDate__c})
),
{!$Record.ProjectApprovalDate__c},
{!Obter_Caso.ProjectApprovalDate__c}
)</expression>
    </formulas>
    <formulas>
        <name>criarNovaTask</name>
        <dataType>Boolean</dataType>
        <expression>OR(
{!$Record.Subject} = &quot;Projeto finalizado&quot;,
{!$Record.Subject} = &quot;Instalação Geral&quot;,
{!$Record.Subject} = &quot;Instalação Material&quot;,
{!$Record.Subject} = &quot;Instalação&quot;,
{!$Record.Subject} = &quot;Instalação Vistoria&quot;,
{!$Record.Subject} = &quot;Ligação Concluída&quot;
)</expression>
    </formulas>
    <formulas>
        <name>DataDaSolicitacaoDeVistoriaPreenchida</name>
        <dataType>Boolean</dataType>
        <expression>false</expression>
    </formulas>
    <formulas>
        <name>dataDeInicioDaObraPreenchido</name>
        <dataType>Boolean</dataType>
        <expression>AND(
ISCHANGED({!$Record.StartDateWork__c}),
NOT(ISNULL({!$Record.StartDateWork__c}))
)</expression>
    </formulas>
    <formulas>
        <name>dateAdditionalMaterialFormated</name>
        <dataType>String</dataType>
        <expression>LPAD(TEXT(DAY({!$Record.DateAdditionalMaterial__c})), 2, &quot;0&quot;) &amp; &quot;/&quot; &amp; 
LPAD(TEXT(MONTH({!$Record.DateAdditionalMaterial__c})), 2, &quot;0&quot;) &amp; &quot;/&quot; &amp; 
TEXT(YEAR({!$Record.DateAdditionalMaterial__c}))</expression>
    </formulas>
    <formulas>
        <name>dateInspectionFormula</name>
        <dataType>DateTime</dataType>
        <expression>{!$Record.DateInspection__c} + 14</expression>
    </formulas>
    <formulas>
        <name>dateWegFormated</name>
        <dataType>String</dataType>
        <expression>LPAD(TEXT(DAY({!$Record.EstimatedDateKitWeb__c})), 2, &quot;0&quot;) &amp; &quot;/&quot; &amp; 
LPAD(TEXT(MONTH({!$Record.EstimatedDateKitWeb__c})), 2, &quot;0&quot;) &amp; &quot;/&quot; &amp; 
TEXT(YEAR({!$Record.EstimatedDateKitWeb__c}))</expression>
    </formulas>
    <formulas>
        <name>ISNEW</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>newTaskMaterialOrNext</name>
        <dataType>String</dataType>
        <expression>IF( 
    AND(
        {!$Record.Subject} = &quot;Instalação - Materiais&quot;, 
        NOT(ISNULL({!$Record.DateAdditionalMaterial__c})),
        ISNULL({!Consultar_Caso_de_Jornada_do_Cliente.EstimatedDateKitWeb__c})
    ), 
    &quot;Instalação - Materiais&quot;,
    IF(
        AND(
            {!$Record.Subject} = &quot;Instalação - Materiais&quot;, 
            NOT(ISNULL({!$Record.EstimatedDateKitWeb__c})),
            ISNULL({!Consultar_Caso_de_Jornada_do_Cliente.DateAdditionalMaterial__c})
        ), 
        &quot;Instalação - Materiais&quot;,
        IF(
          OR( 
                    AND(
                              {!$Record.Subject} = &quot;Instalação - Materiais&quot;, 
                              NOT(ISNULL({!Consultar_Caso_de_Jornada_do_Cliente.EstimatedDateKitWeb__c})),
                              NOT(ISNULL({!$Record.DateAdditionalMaterial__c}))
                     ),
                    AND(
                              {!$Record.Subject} = &quot;Instalação - Materiais&quot;, 
                              NOT(ISNULL({!$Record.EstimatedDateKitWeb__c})),
                              NOT(ISNULL({!Consultar_Caso_de_Jornada_do_Cliente.DateAdditionalMaterial__c}))
                     )
           )
            , 
            &quot;Instalação - Montagem&quot;,
            &quot;&quot;
        )
    )
)</expression>
    </formulas>
    <formulas>
        <name>nextNotificationText</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Subject} = &quot;Onboarding&quot;, &quot;Após 30 dias de hoje&quot;, 
      IF({!$Record.Subject} = &quot;Entrega do Kit WEG&quot;,  &quot;Após 15 dias de hoje&quot;, 
     IF({!$Record.Subject} = &quot;Instalação&quot;,  &quot;Após 15 dias de hoje&quot;, &quot;Após 15 dias de hoje&quot;
)))</expression>
    </formulas>
    <formulas>
        <name>nextSubjectAndStatus</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Subject} = &quot;Onboarding&quot;, &quot;Informações Iniciais&quot;, 
      IF({!$Record.Subject} = &quot;Informações Iniciais&quot;,  &quot;Projeto Aprovado&quot;, 
     IF({!$Record.Subject} = &quot;Projeto Aprovado&quot;,  &quot;Instalação - Materiais&quot;,
          IF({!$Record.Subject} = &quot;Instalação - Materiais&quot;, {!newTaskMaterialOrNext} ,
     IF({!$Record.Subject} = &quot;Instalação - Montagem&quot;, &quot;Instalação - Vistoria&quot;,
     IF({!$Record.Subject} = &quot;Instalação - Vistoria&quot;, &quot;Ligação Concluída&quot;, 
    IF({!$Record.Subject} = &quot;Ligação Concluída&quot;, &quot;Start&quot;,
   IF({!$Record.Subject} = &quot;Start&quot;,&quot;Monitoramento&quot;,
   IF({!$Record.Subject} = &quot;Monitoramento&quot;, &quot;Closed&quot;, &quot;&quot;
)))))))))</expression>
    </formulas>
    <formulas>
        <name>oppNameFormula</name>
        <dataType>String</dataType>
        <expression>{!Obter_Oportunidade.Numeroproposta__c} + &quot; - &quot; + {!Obter_Oportunidade.Name}</expression>
    </formulas>
    <formulas>
        <name>PrazoDeVistoriaPreenchido</name>
        <dataType>Boolean</dataType>
        <expression>AND(AND(ISCHANGED({!$Record.InspectionDays__c}),
NOT(ISNULL({!$Record.InspectionDays__c})))
)</expression>
    </formulas>
    <formulas>
        <name>PrevisaoEntregaKitWEGPreenchida</name>
        <dataType>Boolean</dataType>
        <expression>AND(ISCHANGED({!$Record.EstimatedDateKitWeb__c}),
NOT(ISNULL({!$Record.EstimatedDateKitWeb__c})))</expression>
    </formulas>
    <formulas>
        <name>PrevisaoPreenchida</name>
        <dataType>Boolean</dataType>
        <expression>AND(ISCHANGED({!$Record.InstallationPlanned__c}),
NOT(ISNULL({!$Record.InstallationPlanned__c})))</expression>
    </formulas>
    <formulas>
        <name>targetDate</name>
        <dataType>Date</dataType>
        <expression>IF({!$Record.Subject} = &quot;Onboarding&quot;, TODAY() + 10, 
     IF({!$Record.Subject} = &quot;Informações Iniciais&quot;, TODAY() + 15,
     IF({!$Record.Subject} = &quot;Projeto Aprovado&quot;, TODAY() + 5,
     IF({!$Record.Subject} = &quot;Instalação - Materiais&quot;, TODAY() + 5,
     IF({!$Record.Subject} = &quot;Instalação - Montagem&quot;, TODAY(),
    IF({!$Record.Subject} = &quot;Instalação - Vistoria&quot;, TODAY() + 14,
   IF({!$Record.Subject} = &quot;Ligação Concluída&quot;, TODAY() + 5,
IF({!$Record.Subject} = &quot;Start&quot;, TODAY() + 5, TODAY() + 7
))))))))</expression>
    </formulas>
    <interviewLabel>Task - After {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Task - Jornada do Cliente</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Criar_Messaging_User</name>
        <label>Criar Messaging User</label>
        <locationX>578</locationX>
        <locationY>1595</locationY>
        <assignRecordIdToReference>messagingUserId</assignRecordIdToReference>
        <connector>
            <targetReference>Atribuir_messagingUserId_criado</targetReference>
        </connector>
        <inputAssignments>
            <field>ContactId</field>
            <value>
                <elementReference>Consultar_Cliente.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageType</field>
            <value>
                <stringValue>WhatsApp</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessagingChannelId</field>
            <value>
                <elementReference>Consultar_Messaging_Channel.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessagingConsentStatus</field>
            <value>
                <stringValue>ImplicitlyOptedIn</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessagingPlatformKey</field>
            <value>
                <elementReference>Consultar_Cliente.Telefone_Formatado__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Name</field>
            <value>
                <elementReference>Consultar_Cliente.Name</elementReference>
            </value>
        </inputAssignments>
        <object>MessagingEndUser</object>
    </recordCreates>
    <recordCreates>
        <name>Criar_task_do_step_seguinte</name>
        <label>Criar task do step seguinte</label>
        <locationX>644</locationX>
        <locationY>3551</locationY>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>targetDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ConcessionariaEnergia__c</field>
            <value>
                <elementReference>managerName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CreateNewTaskAutomatically__c</field>
            <value>
                <elementReference>criarNovaTask</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>InstallDate__c</field>
            <value>
                <elementReference>caseInstallDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>NextNotification__c</field>
            <value>
                <elementReference>nextNotification</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>nextStep</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>Jornada do Projeto</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>$Record.WhatId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhoId</field>
            <value>
                <elementReference>$Record.WhoId</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Consultar_Caso_de_Jornada_do_Cliente</name>
        <label>Consultar Caso de Jornada do Cliente</label>
        <locationX>512</locationX>
        <locationY>947</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Consultar_Cliente</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WhatId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Consultar_Cliente</name>
        <label>Consultar Cliente</label>
        <locationX>512</locationX>
        <locationY>1055</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Consultar_Messaging_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WhoId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Consultar_ltimo_messaging_session</name>
        <label>Consultar último messaging session</label>
        <locationX>512</locationX>
        <locationY>3227</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Atualizar_Messaging_Session_Com_caso_de_jornada</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>MessagingEndUserId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>messagingUserId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>MessagingSession</object>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Consultar_Messaging_Channel</name>
        <label>Consultar Messaging Channel</label>
        <locationX>512</locationX>
        <locationY>539</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Tipo_de_Task</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>WHATSAPP_US_610227168839050</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>MessagingChannel</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Consultar_Messaging_User</name>
        <label>Consultar Messaging User</label>
        <locationX>512</locationX>
        <locationY>1163</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Consultar_Messaging_User_Consultor</targetReference>
        </connector>
        <filterLogic>2 AND (1 OR 3)</filterLogic>
        <filters>
            <field>ContactId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WhoId</elementReference>
            </value>
        </filters>
        <filters>
            <field>MessagingChannelId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Consultar_Messaging_Channel.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Telefone_Formatado__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Consultar_Cliente.Telefone_Formatado__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>MessagingEndUser</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Consultar_Messaging_User_Consultor</name>
        <label>Consultar Messaging User Consultor</label>
        <locationX>512</locationX>
        <locationY>1271</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Obter_Oportunidade</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Consultor__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Consultar_Caso_de_Jornada_do_Cliente.Nome_do_Consultor__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>MessagingEndUser</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obter_Caso</name>
        <label>Obter Caso</label>
        <locationX>512</locationX>
        <locationY>3011</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Atualizar_Caso_relacionado</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WhatId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obter_Oportunidade</name>
        <label>Obter Oportunidade</label>
        <locationX>512</locationX>
        <locationY>1379</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Verificar_se_Messaging_User_existe</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Consultar_Caso_de_Jornada_do_Cliente.Nome_da_Oportunidade__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Obter_Usuario_Owner</name>
        <label>Obter Usuario Owner</label>
        <locationX>1084</locationX>
        <locationY>323</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Task_de_Jornada_do_Cliente</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Username</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>elenara.rodrigues@enerzee.com.br</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Atualizar_Caso_relacionado</name>
        <label>Atualizar Caso relacionado</label>
        <locationX>512</locationX>
        <locationY>3119</locationY>
        <connector>
            <targetReference>Consultar_ltimo_messaging_session</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WhatId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>DateAdditionalMaterial__c</field>
            <value>
                <elementReference>caseAdditionalMaterial</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>DateInspection__c</field>
            <value>
                <elementReference>caseDateInspection</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EstimatedDateKitWeb__c</field>
            <value>
                <elementReference>caseEstimatedKITWeg</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>InstallDate__c</field>
            <value>
                <elementReference>caseInstallDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>KWP__c</field>
            <value>
                <elementReference>caseKWP</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Link__c</field>
            <value>
                <elementReference>caseLink</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Login__c</field>
            <value>
                <elementReference>caseLogin</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MonitoringApplication__c</field>
            <value>
                <elementReference>caseApp</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Password__c</field>
            <value>
                <elementReference>casePassword</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ProjectApprovalDate__c</field>
            <value>
                <elementReference>caseProjectApprovalDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <elementReference>nextStep</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Atualizar_Messaging_Session_Com_caso_de_jornada</name>
        <label>Atualizar Messaging Session Com caso de jornada</label>
        <locationX>512</locationX>
        <locationY>3335</locationY>
        <connector>
            <targetReference>Verificar_se_deve_criar_nova_task</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Consultar_ltimo_messaging_session.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>CaseId</field>
            <value>
                <elementReference>$Record.WhatId</elementReference>
            </value>
        </inputAssignments>
        <object>MessagingSession</object>
    </recordUpdates>
    <recordUpdates>
        <name>Fechar_Task</name>
        <label>Fechar Task</label>
        <locationX>512</locationX>
        <locationY>2903</locationY>
        <connector>
            <targetReference>Obter_Caso</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>958</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Obter_Usuario_Owner</targetReference>
        </connector>
        <object>Task</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>agentName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>app</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>customerName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>dateAdditionalMaterial</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>dateAdditionalMaterialFormatedStr</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>dateWegMaterial</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>dateWegMaterialFormated</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>estimatedDateInstallation</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>estimatedDateKitWEG</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>imgId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>inspectionDate</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>inspectionDeadLine</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>installDate</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>kwp</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>link</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>login</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>managerName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>messageGUIDs</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>messagingUserId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>messagingUserIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>messagingUserIdsConsultant</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>nextAction</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>nextNotification</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>nextStep</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>oppName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>password</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>requestDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
