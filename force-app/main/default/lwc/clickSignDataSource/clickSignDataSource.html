<template>
    <div class="data-source-container">
        <!-- Loading Spinner -->
        <template if:true={isLoading}>
            <div class="loading-spinner">
                <lightning-spinner alternative-text="Loading..."></lightning-spinner>
            </div>
        </template>
        <template if:false={isLoading}>
            <!-- Selected Object -->
            <template if:true={selectedObject}>
                <p style="padding-top: 10px;padding-bottom: 10px;">{labels.selectDataSource}</p>
                <div class="selected-record">
                    <lightning-icon icon-name={selectedObjectIcon} size="small" alternative-text={selectedObjectLabel}></lightning-icon>
                    <span>{selectedObjectLabel}</span>
                    <template if:false={disableObjectSelection}>
                        <button class="remove-button" onclick={removeObjectSelection}>âœ–</button>
                    </template>
                </div>
            </template>

            <!-- Object Selection -->
            <template if:false={selectedObject}>
                <lightning-input
                    type="search"
                    label={labels.selectDataSource}
                    placeholder={labels.search}
                    onchange={handleSearch}
                ></lightning-input>
                <div class="data-source-dropdown">
                    <div class="group">
                        <h3 class="group-title">{labels.mostCommonlyUsed}</h3>
                        <ul>
                            <template for:each={mostCommonlyUsed} for:item="item">
                                <li key={item.value} class="data-item" onclick={handleObjectSelection} data-value={item.value}>
                                    <lightning-icon icon-name={item.icon} size="small" alternative-text={item.label}></lightning-icon>
                                    <span>{item.label}</span>
                                </li>
                            </template>
                        </ul>
                    </div>
                    <div class="group">
                        <h3 class="group-title">{labels.otherItems}</h3>
                        <ul>
                            <template for:each={otherItems} for:item="item">
                                <li key={item.value} class="data-item" onclick={handleObjectSelection} data-value={item.value}>
                                    <lightning-icon icon-name={item.icon} size="small" alternative-text={item.label}></lightning-icon>
                                    <span>{item.label}</span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
            </template>

            <!-- Record Search -->
            <template if:true={showRecordSearch}>
                <lightning-input
                    type="search"
                    label={labels.searchRecords}
                    placeholder={labels.search}
                    onchange={handleSearch}
                ></lightning-input>
                <div class="record-list">
                    <ul>
                        <template if:true={records}>
                            <template for:each={records} for:item="record">
                                <li key={record.Id} class="record-item" onclick={handleRecordSelection} data-value={record.Id}>
                                    <lightning-icon icon-name={record.icon} size="small" alternative-text={record.objectLabel}></lightning-icon>
                                    <span>{record.objectLabel}</span>
                                </li>
                            </template>
                        </template>
                        <template if:false={records}>
                            <li class="no-records">{labels.noRecordsFound}</li>
                        </template>
                    </ul>
                </div>
            </template>
        </template>
    </div>
</template>