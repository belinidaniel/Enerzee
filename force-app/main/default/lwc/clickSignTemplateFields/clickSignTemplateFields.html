<template>
    <div class="slds-p-around_medium">
        <template if:false={isContactInfo}>
            <h2 class="slds-text-heading_medium">{labels.salesforceFields}</h2>
        </template>
        <template if:true={isContactInfo}>
            <h2 class="slds-text-heading_medium">{labels.salesforceContactFields}</h2>
        </template>
        <template for:each={selectedFields} if:false={isContactInfo} for:item="field">
            <div key={field.id} class="slds-grid slds-gutters slds-wrap slds-m-bottom_small">
                <!-- Object Fields -->
                <div class="slds-col slds-size_1-of-3">
                    <c-hierarchical-field-picker
                        key={field.id}
                        label={labels.objectFields}
                        options={objectFields}
                        is-contact-info={isContactInfo}
                        options-relationship={relationshipFields}
                        options-related={lookupFields}
                        selected-value={field.fieldName}
                        object-name={objectName}
                        label-field-name={field.labelFieldName}
                        label-related-field={field.labelRelatedField}
                        data-index={field.id}
                        template-id={templateId}
                        onselectioncontactchange={handleContactFieldChange}
                        onselectionchange={handleFieldChange}>
                    </c-hierarchical-field-picker>
                </div>

                <!-- Anchor Text -->
                <div class="slds-col slds-size_2-of-3 slds-grid slds-align_absolute-center">
                    <template if:false={isContactInfo}>
                        <lightning-input
                            style="width: 40%;"
                            label={labels.anchorText}
                            value={field.tagLabel}
                            readonly>
                        </lightning-input>
                        <lightning-button
                            label={labels.copy}
                            icon-name="utility:copy"
                            variant="neutral"
                            class="slds-m-left_small"
                            onclick={handleCopy}
                            data-tag={field.tagLabel}>
                        </lightning-button>
                        <template if:false={isContactInfo}>
                            <lightning-button
                                label={labels.delete}
                                icon-name="utility:delete"
                                variant="destructive"
                                class="slds-m-left_small"
                                data-index={field.id}
                                onclick={removeField}>
                            </lightning-button>
                        </template>
                    </template>
                </div>
            </div>
        </template>
        <template for:each={selectedContactFields} if:true={isContactInfo} for:item="field">
            <div key={field.id} class="slds-grid slds-gutters slds-wrap slds-m-bottom_small">
                <!-- Object Fields -->
                <div class="slds-col slds-size_1-of-3">
                    <c-hierarchical-field-picker
                        key={field.id}
                        label={labels.objectFields}
                        options={objectFields}
                        is-contact-info={isContactInfo}
                        options-relationship={relationshipFields}
                        options-related={lookupFields}
                        selected-value={field.fieldName}
                        object-name={objectName}
                        label-related-field={field.emailField}
                        label-role-field={field.labelRoleField}
                        data-index={field.id}
                        template-id={templateId}
                        onselectioncontactchange={handleContactFieldChange}
                        onselectionchange={handleFieldChange}>
                    </c-hierarchical-field-picker>
                </div>
            </div>
        </template>
        <template if:false={isContactInfo}>

            <lightning-button
                label={labels.addField}
                onclick={addField}
                class="slds-m-top_medium">
            </lightning-button>
        </template>
    </div>
</template>